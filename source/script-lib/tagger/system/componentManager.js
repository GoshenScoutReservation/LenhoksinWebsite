"use strict";define(["system/logManager","system/text","system/linq","system/guid","system/mvc/mvc"],function(e,t,r,n,o){function a(){function e(e){try{return JSON.parse(e)}catch(t){return e}}function a(a){var u=a.getAttribute("component-id");if(null===u){u=n.create(),a.setAttribute("component-id",u);var s=a.tagName.toUpperCase();!c[s]&&document.registerElement&&(c[s]=document.registerElement(s,{prototype:Object.create(HTMLDivElement.prototype),"extends":"DIV"})),a.style.display="block";var m=t.from("controllers/{0}Controller",t.camelCase(s)),f={},p=a.querySelector("script[type='application/json'][role='config']");p&&(f=JSON.parse(p.innerHTML),a.removeChild(p));var g=["class","style","id","title"];r.Enumerable.from(a.attributes).forEach(function(r){var n=t.camelCase(r.name);g.indexOf(n)>=0||(f[n]=e(r.value))}),i.debug("Starting component {0}",s),require([m],function(e){var t=new e(a,f);t.start&&t.start(),l[u]=t,r.Enumerable.from(a.querySelectorAll("[model]")).any()&&o.createComponentScope(u,{view:a,controller:t})},function(e){i.error("Unable to load {0}: {1}",s,e.message)})}}var c={},l={};this.getController=function(e){var t=e.getAttribute("component-id");return t?l[t]||null:null},this.bootstrap=a,this.scan=function(){i.debug("Scanning for components");var e=document.querySelectorAll("*");r.Enumerable.from(e).where(function(e){return-1!==e.tagName.indexOf("-")&&"false"!==e.getAttribute("auto-wire-up")}).forEach(function(e){return a(e)})}}var i=e.getLogger("Component Loader");return new a});
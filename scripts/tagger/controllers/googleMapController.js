"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,o,t){return o&&e(n.prototype,o),t&&e(n,t),n}}();define(["system/logManager","constants"],function(e,n){var o=e.getLogger("Google Map Controller");return function(){function e(n,o){_classCallCheck(this,e),this.element=n,this.config=o}return _createClass(e,[{key:"start",value:function(){var e=this;require(["async!https://maps.googleapis.com/maps/api/js?key="+n.googleMapsApiKey],function(){return void e.initializeMap(window.google.maps)})}},{key:"initializeMap",value:function(e){var n=this;if(!e)throw new Error("Unable to load Google Maps API");var t=this.config.coordinates;if(t)return void this.renderMap(e,t);var r=this.config.address,a=new e.Geocoder;o.debug("Geocoding address '{0}'",r),a.geocode({address:r},function(t,r){if(r!==e.GeocoderStatus.OK)return void o.error("Geocoding failed with code {0}",r);var a=t[0].geometry.location;o.debug("Got geocode result {0}.",a),n.renderMap(e,a)})}},{key:"renderMap",value:function(e,n){var o=this,t=function(n){switch(n){case"road":return e.MapTypeId.ROADMAP;case"terrain":return e.MapTypeId.TERRAIN;case"satellite":return e.MapTypeId.SATTELITE;default:return e.MapTypeId.ROADMAP}},r=new e.Map(this.element,{center:n,zoom:this.config.zoom||16,scrollwheel:!1,zoomControl:!1,draggable:!1,navigationControl:!1,mapTypeControl:!1,mapTypeId:t(this.config.type)}),a=new e.Marker({map:r,position:n,animation:e.Animation.DROP});this.config.info&&!function(){var n=new e.InfoWindow({content:o.config.info});a.addListener("click",function(e){return n.open(r,a)}),n.open(r,a)}()}}]),e}()});